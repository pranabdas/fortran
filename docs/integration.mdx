---
title: "Numerical integration: Trapezoidal method"
sidebar_label: Numerical integration
---
import CodeBlock from '@theme/CodeBlock';

We will calculate the area under the curve $f(x)$ within the bounds $x=a$ and
$x=b$. We will divide the curve into $n$ trapezoids with width $h=(b-a)/n$. Area
under the curve:

$$
A_n = h \left[\frac{f(a)}{2} + f(a+h) + f(a+2h) + \cdots + \frac{f(b)}{2}\right]
$$

import trapezoid from '!!raw-loader!/src/10_trapezoid.f90';

<CodeBlock className="fortran" title="src/10_trapezoid.f90">{trapezoid}</CodeBlock>

Later we will improve this code one we introduce about modules and [procedures](
/fortran/procedures#numerical-integration-ii).

## Numerical integration II
We will try to improve above numerical integration code. Previously we had the
integration function hard coded, now we will pass it as argument from the
calling program and use separate module for the calculation.

First we write our executable code in a module:

import integration_module from '!!raw-loader!/src/14_integration_module.f90';

<CodeBlock className="fortran" title="src/14_integration_module.f90">{integration_module}</CodeBlock>

import integration from '!!raw-loader!/src/14_integration.f90';

<CodeBlock className="fortran" title="src/14_integration.f90">{integration}</CodeBlock>
