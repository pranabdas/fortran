"use strict";(self.webpackChunkfortran_programing=self.webpackChunkfortran_programing||[]).push([["173"],{8252(s,a,e){e.r(a),e.d(a,{metadata:()=>n,default:()=>x,frontMatter:()=>r,contentTitle:()=>t,toc:()=>h,assets:()=>c});var n=JSON.parse('{"id":"coding-practice/integration","title":"Numerical integration: Trapezoidal method","description":"We will calculate the area under the curve $f(x)$ within the bounds $x=a$ and","source":"@site/docs/coding-practice/04-integration.mdx","sourceDirName":"coding-practice","slug":"/coding-practice/integration","permalink":"/fortran/coding-practice/integration","draft":false,"unlisted":false,"editUrl":"https://github.com/pranabdas/fortran/blob/main/docs/coding-practice/04-integration.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Numerical integration: Trapezoidal method","sidebar_label":"Numerical integration"},"sidebar":"docs","previous":{"title":"Calculate hypotenuse","permalink":"/fortran/coding-practice/hypotenuse"},"next":{"title":"Haversine formula","permalink":"/fortran/coding-practice/haversine"}}'),l=e(4848),i=e(8453),m=e(1113);let r={title:"Numerical integration: Trapezoidal method",sidebar_label:"Numerical integration"},t,c={},h=[{value:"Numerical integration II",id:"numerical-integration-ii",level:2}];function d(s){let a={annotation:"annotation",h2:"h2",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msub:"msub",p:"p",semantics:"semantics",span:"span",...(0,i.R)(),...s.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(a.p,{children:["We will calculate the area under the curve ",(0,l.jsxs)(a.span,{className:"katex",children:[(0,l.jsx)(a.span,{className:"katex-mathml",children:(0,l.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(a.semantics,{children:[(0,l.jsxs)(a.mrow,{children:[(0,l.jsx)(a.mi,{children:"f"}),(0,l.jsx)(a.mo,{stretchy:"false",children:"("}),(0,l.jsx)(a.mi,{children:"x"}),(0,l.jsx)(a.mo,{stretchy:"false",children:")"})]}),(0,l.jsx)(a.annotation,{encoding:"application/x-tex",children:"f(x)"})]})})}),(0,l.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,l.jsx)(a.span,{className:"mopen",children:"("}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"x"}),(0,l.jsx)(a.span,{className:"mclose",children:")"})]})})]})," within the bounds ",(0,l.jsxs)(a.span,{className:"katex",children:[(0,l.jsx)(a.span,{className:"katex-mathml",children:(0,l.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(a.semantics,{children:[(0,l.jsxs)(a.mrow,{children:[(0,l.jsx)(a.mi,{children:"x"}),(0,l.jsx)(a.mo,{children:"="}),(0,l.jsx)(a.mi,{children:"a"})]}),(0,l.jsx)(a.annotation,{encoding:"application/x-tex",children:"x=a"})]})})}),(0,l.jsxs)(a.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"0.4306em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"x"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(a.span,{className:"mrel",children:"="}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"0.4306em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"a"})]})]})]})," and\n",(0,l.jsxs)(a.span,{className:"katex",children:[(0,l.jsx)(a.span,{className:"katex-mathml",children:(0,l.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(a.semantics,{children:[(0,l.jsxs)(a.mrow,{children:[(0,l.jsx)(a.mi,{children:"x"}),(0,l.jsx)(a.mo,{children:"="}),(0,l.jsx)(a.mi,{children:"b"})]}),(0,l.jsx)(a.annotation,{encoding:"application/x-tex",children:"x=b"})]})})}),(0,l.jsxs)(a.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"0.4306em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"x"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(a.span,{className:"mrel",children:"="}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"0.6944em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"b"})]})]})]}),". We will divide the curve into ",(0,l.jsxs)(a.span,{className:"katex",children:[(0,l.jsx)(a.span,{className:"katex-mathml",children:(0,l.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(a.semantics,{children:[(0,l.jsx)(a.mrow,{children:(0,l.jsx)(a.mi,{children:"n"})}),(0,l.jsx)(a.annotation,{encoding:"application/x-tex",children:"n"})]})})}),(0,l.jsx)(a.span,{className:"katex-html","aria-hidden":"true",children:(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"0.4306em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"n"})]})})]})," trapezoids with width ",(0,l.jsxs)(a.span,{className:"katex",children:[(0,l.jsx)(a.span,{className:"katex-mathml",children:(0,l.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,l.jsxs)(a.semantics,{children:[(0,l.jsxs)(a.mrow,{children:[(0,l.jsx)(a.mi,{children:"h"}),(0,l.jsx)(a.mo,{children:"="}),(0,l.jsx)(a.mo,{stretchy:"false",children:"("}),(0,l.jsx)(a.mi,{children:"b"}),(0,l.jsx)(a.mo,{children:"\u2212"}),(0,l.jsx)(a.mi,{children:"a"}),(0,l.jsx)(a.mo,{stretchy:"false",children:")"}),(0,l.jsx)(a.mi,{mathvariant:"normal",children:"/"}),(0,l.jsx)(a.mi,{children:"n"})]}),(0,l.jsx)(a.annotation,{encoding:"application/x-tex",children:"h=(b-a)/n"})]})})}),(0,l.jsxs)(a.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"0.6944em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"h"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(a.span,{className:"mrel",children:"="}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(a.span,{className:"mopen",children:"("}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"b"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"a"}),(0,l.jsx)(a.span,{className:"mclose",children:")"}),(0,l.jsx)(a.span,{className:"mord",children:"/"}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"n"})]})]})]}),". Area\nunder the curve:"]}),"\n",(0,l.jsx)(a.span,{className:"katex-display",children:(0,l.jsxs)(a.span,{className:"katex",children:[(0,l.jsx)(a.span,{className:"katex-mathml",children:(0,l.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(a.semantics,{children:[(0,l.jsxs)(a.mrow,{children:[(0,l.jsxs)(a.msub,{children:[(0,l.jsx)(a.mi,{children:"A"}),(0,l.jsx)(a.mi,{children:"n"})]}),(0,l.jsx)(a.mo,{children:"="}),(0,l.jsx)(a.mi,{children:"h"}),(0,l.jsxs)(a.mrow,{children:[(0,l.jsx)(a.mo,{fence:"true",children:"["}),(0,l.jsxs)(a.mfrac,{children:[(0,l.jsxs)(a.mrow,{children:[(0,l.jsx)(a.mi,{children:"f"}),(0,l.jsx)(a.mo,{stretchy:"false",children:"("}),(0,l.jsx)(a.mi,{children:"a"}),(0,l.jsx)(a.mo,{stretchy:"false",children:")"})]}),(0,l.jsx)(a.mn,{children:"2"})]}),(0,l.jsx)(a.mo,{children:"+"}),(0,l.jsx)(a.mi,{children:"f"}),(0,l.jsx)(a.mo,{stretchy:"false",children:"("}),(0,l.jsx)(a.mi,{children:"a"}),(0,l.jsx)(a.mo,{children:"+"}),(0,l.jsx)(a.mi,{children:"h"}),(0,l.jsx)(a.mo,{stretchy:"false",children:")"}),(0,l.jsx)(a.mo,{children:"+"}),(0,l.jsx)(a.mi,{children:"f"}),(0,l.jsx)(a.mo,{stretchy:"false",children:"("}),(0,l.jsx)(a.mi,{children:"a"}),(0,l.jsx)(a.mo,{children:"+"}),(0,l.jsx)(a.mn,{children:"2"}),(0,l.jsx)(a.mi,{children:"h"}),(0,l.jsx)(a.mo,{stretchy:"false",children:")"}),(0,l.jsx)(a.mo,{children:"+"}),(0,l.jsx)(a.mo,{children:"\u22EF"}),(0,l.jsx)(a.mo,{children:"+"}),(0,l.jsxs)(a.mfrac,{children:[(0,l.jsxs)(a.mrow,{children:[(0,l.jsx)(a.mi,{children:"f"}),(0,l.jsx)(a.mo,{stretchy:"false",children:"("}),(0,l.jsx)(a.mi,{children:"b"}),(0,l.jsx)(a.mo,{stretchy:"false",children:")"})]}),(0,l.jsx)(a.mn,{children:"2"})]}),(0,l.jsx)(a.mo,{fence:"true",children:"]"})]})]}),(0,l.jsx)(a.annotation,{encoding:"application/x-tex",children:"A_n = h \\left[\\frac{f(a)}{2} + f(a+h) + f(a+2h) + \\cdots + \\frac{f(b)}{2}\\right]"})]})})}),(0,l.jsxs)(a.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,l.jsxs)(a.span,{className:"mord",children:[(0,l.jsx)(a.span,{className:"mord mathnormal",children:"A"}),(0,l.jsx)(a.span,{className:"msupsub",children:(0,l.jsxs)(a.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(a.span,{className:"vlist-r",children:[(0,l.jsx)(a.span,{className:"vlist",style:{height:"0.1514em"},children:(0,l.jsxs)(a.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(a.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(a.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(a.span,{className:"mord mathnormal mtight",children:"n"})})]})}),(0,l.jsx)(a.span,{className:"vlist-s",children:"\u200B"})]}),(0,l.jsx)(a.span,{className:"vlist-r",children:(0,l.jsx)(a.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(a.span,{})})})]})})]}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(a.span,{className:"mrel",children:"="}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(a.span,{className:"base",children:[(0,l.jsx)(a.span,{className:"strut",style:{height:"2.4em",verticalAlign:"-0.95em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"h"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(a.span,{className:"minner",children:[(0,l.jsx)(a.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,l.jsx)(a.span,{className:"delimsizing size3",children:"["})}),(0,l.jsxs)(a.span,{className:"mord",children:[(0,l.jsx)(a.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(a.span,{className:"mfrac",children:(0,l.jsxs)(a.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(a.span,{className:"vlist-r",children:[(0,l.jsxs)(a.span,{className:"vlist",style:{height:"1.427em"},children:[(0,l.jsxs)(a.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(a.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(a.span,{className:"mord",children:(0,l.jsx)(a.span,{className:"mord",children:"2"})})]}),(0,l.jsxs)(a.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(a.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(a.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(a.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(a.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(a.span,{className:"mord",children:[(0,l.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,l.jsx)(a.span,{className:"mopen",children:"("}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"a"}),(0,l.jsx)(a.span,{className:"mclose",children:")"})]})]})]}),(0,l.jsx)(a.span,{className:"vlist-s",children:"\u200B"})]}),(0,l.jsx)(a.span,{className:"vlist-r",children:(0,l.jsx)(a.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(a.span,{})})})]})}),(0,l.jsx)(a.span,{className:"mclose nulldelimiter"})]}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mbin",children:"+"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,l.jsx)(a.span,{className:"mopen",children:"("}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"a"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mbin",children:"+"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"h"}),(0,l.jsx)(a.span,{className:"mclose",children:")"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mbin",children:"+"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,l.jsx)(a.span,{className:"mopen",children:"("}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"a"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mbin",children:"+"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mord",children:"2"}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"h"}),(0,l.jsx)(a.span,{className:"mclose",children:")"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mbin",children:"+"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"minner",children:"\u22EF"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(a.span,{className:"mbin",children:"+"}),(0,l.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(a.span,{className:"mord",children:[(0,l.jsx)(a.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(a.span,{className:"mfrac",children:(0,l.jsxs)(a.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(a.span,{className:"vlist-r",children:[(0,l.jsxs)(a.span,{className:"vlist",style:{height:"1.427em"},children:[(0,l.jsxs)(a.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(a.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(a.span,{className:"mord",children:(0,l.jsx)(a.span,{className:"mord",children:"2"})})]}),(0,l.jsxs)(a.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(a.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(a.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(a.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(a.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(a.span,{className:"mord",children:[(0,l.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.10764em"},children:"f"}),(0,l.jsx)(a.span,{className:"mopen",children:"("}),(0,l.jsx)(a.span,{className:"mord mathnormal",children:"b"}),(0,l.jsx)(a.span,{className:"mclose",children:")"})]})]})]}),(0,l.jsx)(a.span,{className:"vlist-s",children:"\u200B"})]}),(0,l.jsx)(a.span,{className:"vlist-r",children:(0,l.jsx)(a.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(a.span,{})})})]})}),(0,l.jsx)(a.span,{className:"mclose nulldelimiter"})]}),(0,l.jsx)(a.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,l.jsx)(a.span,{className:"delimsizing size3",children:"]"})})]})]})]})]})}),"\n","\n",(0,l.jsx)(m.A,{language:"fortran",title:"src/10_trapezoid.f90",showLineNumbers:!0,children:'! Caculate the area of sine curve using trapezoidal method\n\nPROGRAM trapezoid\n  IMPLICIT none\n\n  INTRINSIC :: sin\n  REAL :: a, b, h, area\n  INTEGER :: i, n\n\n  n = 100\n  a = 0\n  b = 3.14\n\n  h = (b - a) / n\n\n  area = 0.5 * (sin(a) + sin(b))\n\n  DO i = 1, n-1\n    area = area + sin(a + i*h)\n  END DO\n\n  area = h * area\n\n  PRINT *, "Area = ", area\n\nEND PROGRAM trapezoid\n'}),"\n",(0,l.jsx)(a.h2,{id:"numerical-integration-ii",children:"Numerical integration II"}),"\n",(0,l.jsx)(a.p,{children:"We will try to improve above numerical integration code. Previously we had the\nintegration function hard coded, now we will pass it as argument from the\ncalling program and use separate module for the calculation."}),"\n",(0,l.jsx)(a.p,{children:"First we write our executable code in a module:"}),"\n","\n",(0,l.jsx)(m.A,{language:"fortran",title:"src/14_integration_module.f90",showLineNumbers:!0,children:"MODULE integration_module\n  IMPLICIT NONE\n  PRIVATE\n  PUBLIC :: integral\n\n  CONTAINS\n\n  FUNCTION integral(f, a, b, n) RESULT(integral_result)\n\n    INTERFACE\n      FUNCTION f(x) RESULT(f_result)\n        REAL, INTENT(IN) :: x\n        REAL :: f_result\n      END FUNCTION f\n    END INTERFACE\n\n    REAL, INTENT(IN) :: a, b\n    INTEGER, INTENT(IN) :: n\n    REAL :: integral_result\n    REAL :: h, area\n    INTEGER :: i\n\n    h = (b - a) / n\n\n    area = 0.5 * (f(a) + f(b))\n\n    DO i = 1, n-1\n      area = area + f(a + i*h)\n    END DO\n\n    integral_result = h * area\n  END FUNCTION integral\nEND MODULE integration_module\n"}),"\n","\n",(0,l.jsx)(m.A,{language:"fortran",title:"src/14_integration.f90",showLineNumbers:!0,children:"PROGRAM integration\n  USE integration_module\n  IMPLICIT NONE\n  INTRINSIC :: sin\n\n  PRINT *, integral(sin, a=0.0, b=3.14159, n=1000)\nEND PROGRAM integration\n"})]})}function x(s={}){let{wrapper:a}={...(0,i.R)(),...s.components};return a?(0,l.jsx)(a,{...s,children:(0,l.jsx)(d,{...s})}):d(s)}}}]);